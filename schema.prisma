generator client {
    provider             = "prisma-client-py"
    recursive_type_depth = "-1"
    interface            = "asyncio"
}

datasource db {
    provider = "sqlite"
    url      = "file:db.sqlite3"
}

model Mod {
    id               Int      @id
    name             String
    description      String
    mod_updated      DateTime
    last_checked     DateTime
    malformed_pallet Boolean
    thumbnailUrl     String
    nsfw             Boolean?
    files            File[]
}

model File {
    id           Int          @id
    added        DateTime
    url          String
    mod_id       Int
    mod          Mod          @relation(fields: [mod_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
    platform_id  Int
    platform     Platform     @relation(fields: [platform_id], references: [id])
    pallet       Pallet[]
    pallet_error PalletError?
}

model Pallet {
    id         Int    @id @default(autoincrement())
    zip_path   String
    fs_path    String
    barcode    String
    author     String
    version    String
    sdkVersion String
    file_id    Int
    file       File   @relation(fields: [file_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model PalletError {
    id      Int    @id @default(autoincrement())
    error   String
    file_id Int    @unique()
    file    File   @relation(fields: [file_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model Platform {
    id   Int    @id @default(autoincrement())
    name String
    File File[]
}
